
<!DOCTYPE html>
<html>

<body>
    <h1>manyprimes - cryptohack</h1>

    <h2>Challenge Description</h2>
    <p> Using one prime factor was definitely a bad idea so I'll try using over 30 instead.

 If it's taking forever to factorise, read up on factorisation algorithms and make sure you're using one that's optimised for this scenario.


Challenge files:
  - <a href="https://cryptohack.org/static/challenges/output_5a478a5d4764257d0bbdfaed340fcbdd.txt">output.txt</a>

Resources:
  - <a href="https://doc.sagemath.org/html/en/reference/interfaces/sage/interfaces/ecm.html">The Elliptic Curve Factorization Method</a>
 </p>
 
    <h2>Solution Approach</h2>
    <p>Here are the steps we took to solve the challenge:</p>
    <ol>
<pre>
import blog
 
from Crypto.Util.number import bytes_to_long, long_to_bytes,inverse

def solve(n,e,ct,primeList):
  #check primelist  
  
  phi = 1
  for prime in primeList:
    phi *= prime - 1
  d = inverse(e, phi)
  pt = pow(ct, d, n)
  return long_to_bytes(pt)
if __name__ == "__main__" :
 n =blog.set( 580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637,1)
 e = blog.set(65537,2)
 ct =blog.set(320721490534624434149993723527322977960556510750628354856260732098109692581338409999983376131354918370047625150454728718467998870322344980985635149656977787964380651868131740312053755501594999166365821315043312308622388016666802478485476059625888033017198083472976011719998333985531756978678758897472845358167730221506573817798467100023754709109274265835201757369829744113233607359526441007577850111228850004361838028842815813724076511058179239339760639518034583306154826603816927757236549096339501503316601078891287408682099750164720032975016814187899399273719181407940397071512493967454225665490162619270814464,3)
 #check primelist from factorb site if blog.solveup("isprime",n) is slow 
 primeList = [ 9282105380008121879,   9303850685953812323,   9389357739583927789,   10336650220878499841,   10638241655447339831,   11282698189561966721,   11328768673634243077,   11403460639036243901,   11473665579512371723,   11492065299277279799,   11530534813954192171,   11665347949879312361,   12132158321859677597,   12834461276877415051,   12955403765595949597,   12973972336777979701,   13099895578757581201,   13572286589428162097,   14100640260554622013,   14178869592193599187,   14278240802299816541,   14523070016044624039,   14963354250199553339,   15364597561881860737,   15669758663523555763,   15824122791679574573,   15998365463074268941,   16656402470578844539,   16898740504023346457,   17138336856793050757,   17174065872156629921,   17281246625998849649,]
 print(solve(n,e,ct,primeList) )
</pre>
 
</pre>
    </ol>
<br>
    <h2>Flag</h2>
    <p class="flag">crypto{700_m4ny_5m4ll_f4c70r5}</p>

    <h2>Conclusion</h2>
    <p>this is a    medium chanllenge for decrypt message with n that have many prime factors</p>
</body>
</html>



