from pwn import *

# Establish a connection to the remote server
conn = remote('desfunctional.2024.ctfcompetition.com', 1337)

# Receive the challenge (option 1)
challenge_hex = conn.recvuntil(b"flag")
conn.send(b"1\n")
challenge_hex = conn.recvuntil(b"flag").splitlines()[1]
print(challenge_hex)
challenge_bytes = bytes.fromhex(str(challenge_hex))  # Convert the challenge to bytes
print(challenge_bytes)
'''
# Decrypt the ciphertext (option 2)
ct_hex = input("Enter ciphertext (hex): ")
ct_bytes = bytes.fromhex(ct_hex)
decrypted_pt = conn.recvline().decode().strip()

# Derive the key using XOR
key1 = bytes(x ^ y for x, y in zip(ct_bytes, decrypted_pt))

# Construct a plaintext that matches the challenge
# (you can modify this part based on the challenge requirements)
matching_pt = challenge_bytes

# Send the matching plaintext (option 3)
conn.sendline(matching_pt.hex())
flag = conn.recvline().decode().strip()

print("Flag:", flag)

# Close the connection
conn.close()'''
